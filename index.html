<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>动态 NFT Marker AR</title>
    <script src="https://aframe.io/releases/1.4.2/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/AR-js-org/AR.js@3.4.2/aframe/build/aframe-ar-nft.js"></script>
    <style>
      body { margin: 0; font-family: sans-serif; }
      #input-panel {
        position: absolute; top: 20px; left: 20px; background: white;
        padding: 20px; border-radius: 8px; z-index: 999;
      }
    </style>
  </head>
  <body>
    <!-- 输入面板 -->
    <div id="input-panel">
      <label>NFT Marker URL: <input type="text" id="markerUrl" placeholder="nft/sample" /></label><br/><br/>
      <label>Model URL (gltf): <input type="text" id="modelUrl" placeholder="model/scene.gltf" /></label><br/><br/>
      <button onclick="startAR()">下一步</button>
    </div>

    <!-- AR 场景容器 -->
    <div id="scene-container"></div>

    <script>
      function startAR() {
        const markerUrl = document.getElementById('markerUrl').value.trim();
        const modelUrl = document.getElementById('modelUrl').value.trim();

        if (!markerUrl || !modelUrl) {
          alert('请输入完整的 Marker 和模型地址！');
          return;
        }

        // 隐藏输入面板
        document.getElementById('input-panel').style.display = 'none';

        // 创建 A-Frame AR 场景
        const scene = document.createElement('a-scene');
        scene.setAttribute('embedded', '');
        scene.setAttribute('arjs', 'trackingMethod: best; sourceType: webcam; debugUIEnabled: false;');

        const nft = document.createElement('a-nft');
        nft.setAttribute('type', 'nft');
        nft.setAttribute('url', markerUrl);
        nft.setAttribute('smooth', 'true');
        nft.setAttribute('smoothCount', '10');
        nft.setAttribute('smoothTolerance', '0.01');
        nft.setAttribute('smoothThreshold', '5');

        const model = document.createElement('a-entity');
        model.setAttribute('gltf-model', modelUrl);
        model.setAttribute('position', '0 0 0');
        model.setAttribute('scale', '1 1 1');

        nft.appendChild(model);
        scene.appendChild(nft);

        const camera = document.createElement('a-entity');
        camera.setAttribute('camera', '');
        scene.appendChild(camera);

        document.getElementById('scene-container').appendChild(scene);
      }
    </script>
  </body>
</html>
